---
title: 《系统分析与控制》第二章习题
urlname: system-analysis-and-control-chapter-2-exercise
toc: true
mathjax: true
date: 2018-06-22 15:37:30
tags:
---

## 本章内容

### 微分方程模型

建模的最根本方法是根据物理规律，列写出系统运动的微分方程模型。

原始微分方程：直接列写出来的东西。

例：
$$u(t) = L\frac{di(t)}{dt} + Ri(t) + u_c(t) \\\\
i(t) = C \frac{du_c(t)}{dt}$$

高阶微分方程：将所有原始微分方程合并为一个总的微分方程，在该方程中，只包含输入量、输出量及它们的导数项。相应系统的阶次等于微分方程的阶次（最高阶导数）。

高阶微分方程例（$u_c(t)$为输出量，$u(t)$为输入量）：
$$LC \frac{d^2 u_c(t)}{dt^2} + RC \frac{du_c(t)}{dt} + u_c(t) = u(t)$$

一阶微分方程组：每个方程只包含一个变量的一阶导数，方程的个数等于未知变量的个数，这些未知变量也称为状态变量，它们是系统中的独立变量。这些状态变量完全确定了系统的状态，其个数就等于系统的阶次。

一阶微分方程组例：

$$
\begin{cases}
\frac{di(t)}{dt} = -\frac{R}{L}i(t) - \frac{1}{L}u_c(t) + \frac{1}{L}u(t) \\\\
\frac{du_c(t)}{dt} = \frac{1}{C}i(t)
\end{cases}
$$

### 传递函数模型

传递函数模型从本质上来说，只是利用Laplace变换对高阶微分方程模型的另一种表示方法而已。设系统的高阶微分方程为：

$$y^{(n)}(t) + a_1 y^{(n-1)}(t) + \dots + a_{n-1} \dot{y}(t) + a_n y(t) \\\\ = b_0 u^{(m)}(t) + b_1 u^{(m-1)}(t) + \dots b_{m-1}\dot{u}(t) + b_m u(t)$$

其中$u(t)$是输入量，$y(t)$是输出量，且有$n \geq m$。设系统为零初始条件，两边取Laplace变换，由Laplace变换的微分性质（$\mathcal{L}[f'(t)] = sF(s) - f(0)$）得：

$$(s^n + a_1 s^{n-1} + \dots + a_{n-1}s + a_n) Y(s) \\\\ = (b_0 s^m + b_1 s^{m-1} + \dots + b_{m-1}s + b_m)U(s)$$

定义

$$G(s) = \frac{Y(s)}{U(s)} = \frac{b_0 s^m + b_1 s^{m-1} + \dots + b_{m-1}s + b_m}{s^n + a_1 s^{n-1} + \dots + a_{n-1}s + a_n}$$

为系统的传递函数。也就是说，系统的传递函数是在零初始条件下输出量的Laplace变换与输入量的Laplace变换之比。

传递函数的性质：
1. 传递函数只适用于线性、定常和集总参数系统。
2. 传递函数只与系统的结构参数有关，而与系统的变量无关。因而可以利用它来分析系统本身的一些性质，如稳定性等。
3. 系统的传递函数等于系统的单位脉冲响应的Laplace变换。（证明：$G(s) = \frac{\cal{L}[g(t)]}{\cal{L}[\delta(t)]}=\cal{L}[g(t)]$）
4. 传递函数是以$s$为自变量的复变函数，其中$s = \sigma + j\omega$，称$s$为复频率，$\omega$为角频率。这是由Laplace变换的性质所确定的。
5. 若将$s$看成微分算符，即$s \leftrightarrow \frac{d}{dt}, s^2 \leftrightarrow \frac{d^2}{dt^2}$，则系统的高阶微分方程模型与传递函数模型之间有着十分简单的相互转换关系。（这个性质是显然的……）
6. 一般情况下，传递函数是$s$的有理函数，即传递函数的分子和分母均为$s$的多项式，且一般情况下有$n \geq m$，即分母的阶次大于分子的阶次（否则为物理不可实现系统）。
7. 当系统中包含有纯延时环节时，传递函数具有以下形式：$G(s) = G_0(s) e^{-Ts}$，其中$G_0(s)$表示通常的有理分式传递函数，$T$表示纯延时的大小。
8. 若记$G(s) = N(s) / D(s)$，$N(s)$和$D(s)$分别是$G(s)$的分子和分母多项式，则称$D(s)$为系统的特征多项式，$D(s) = 0$为特征方程。特征多项式的阶次也就是系统的阶次。特征多项式的根决定了系统的许多重要性质，尤其是稳定性。

### 状态方程模型

状态方程模型实质是就是把上述一阶微分方程组模型写成了矩阵和向量的形式。一般情况下，系统的状态方程模型可以表示为：

$$
\begin{cases}
\dot{\mathbf{x}}(t) = A \mathbf{x}(t) + B \mathbf{u}(t) \\\\
\mathbf{y}(t) = C \mathbf{x}(t) + D \mathbf{u}(t)
\end{cases}
$$

其中$\mathbf{x}(t) = \left[  
\begin{array}{ccc}  
x_1(t) &
x_2(t) &
\cdots &  
x_n(t)  
\end{array}  
\right]^T$是$n$维状态向量，$\mathbf{u}(t) = \left[  
\begin{array}{ccc}  
u_1(t) &
u_2(t) &
\cdots &  
u_m(t)  
\end{array}  
\right]^T$是$m$维输入向量，$\mathbf{y}(t) = \left[  
\begin{array}{ccc}  
y_1(t) &
y_2(t) &
\cdots &  
y_r(t)  
\end{array}  
\right]^T$是$r$维输入向量。$A, B, C, D$是系数矩阵，其维数分别为$n \times n, n \times m, r \times n, r \times m$。当系统为单输入和单输出时，$m = r = 1$，$u$和$y$均为标量。此时$B$为$n \times 1$列向量，$C$为$1 \times n$行向量，$D$也为标量。

建立系统状态方程的一般步骤为：
1. 根据物理规律列写原始状态方程
2. 选择状态变量，建立关于这些状态变量的一阶微分方程组
3. 最后再根据一阶微分方程组写出标准的状态方程，同时根据所选输出量写出对应的输出方程

拿出刚才的一阶微分方程组的例子试一下：

$$
\begin{cases}
\frac{di(t)}{dt} = -\frac{R}{L}i(t) - \frac{1}{L}u_c(t) + \frac{1}{L}u(t) \\\\
\frac{du_c(t)}{dt} = \frac{1}{C}i(t)
\end{cases}
$$

令

$$
\mathbf{x} =
\left[
\begin{matrix}
i(t)\\
u_c(t)
\end{matrix}
\right],
A =
\left[
\begin{matrix}
-\frac{R}{L} & -\frac{1}{L}\\\\
\frac{1}{C} & 0
\end{matrix}
\right],
B =
\left[
\begin{matrix}
\frac{1}{L}\\\\
0
\end{matrix}
\right]
$$

则上式可以写成如下矩阵形式：

$$\frac{d\mathbf{x}(t)}{dt} = \dot{\mathbf{x}}(t) = A \mathbf{x}(t) + Bu(t)$$

在该例中，$u_c(t)$是输出量，所以可写出如下输出方程：

$$y(t) = u_c(t) =
\left[
\begin{matrix}
0 & 1
\end{matrix}
\right]
\left[
\begin{matrix}
i(t) \\\\
u_c(t)
\end{matrix}
\right] = C \mathbf{x}(t)
$$

#### 不同状态向量的选择

对于一个系统，其状态向量的选择不是唯一的。若原来选择系统的状态向量为$\mathbf{x}$，满足状态方程，则选择$\overline{\mathbf{x}}(t) = P\mathbf{x}(t)$作为系统状态向量（其中$P$为$n \times n$非奇异矩阵）亦可。此时显然$\overline{\mathbf{x}(t)}$是$\mathbf{x}(t)$的分量的线性组合。容易求得关于$\overline{\mathbf{x}}(t)$的状态方程为：

$$\dot{\overline{\mathbf{x}}}(t) = P \dot{\mathbf{x}}(t) = P (A \mathbf{x}(t) + B \mathbf{u}(t)) \\ = P A P ^{-1} \overline{\mathbf{x}}(t) + P B \mathbf{u}(t)\\ = \overline{A} \overline{\mathbf{x}}(t) + \overline{B} \mathbf{u}(t)$$

$$\mathbf{y}(t) = C\mathbf{x}(t) + D \mathbf{u}(t) = CP^{-1}\overline{\mathbf{x}}(t) + D \mathbf{u}(t) \\ = \overline{C} \overline{\mathbf{x}}(t) + \overline{D} \overline{\mathbf{u}}(t)$$

其中$\overline{A} = P A P^{-1}, \overline{B} = PB, \overline{C} = CP^{-1}, \overline{D} = D$。

### 传递函数模型与状态方程模型的相互转换

状态方程模型实际上属于时域的模型表示，而传递函数模型是属于频域的模型表示。对于同一系统，状态方程可能有多种表示方法，但传递函数只有一种。

#### 状态方程到传递函数的转换

这是一种“多对一”的转换，不过之后可以证明，同一系统不同的状态方程会转换为同一传递函数。

我们都知道，状态方程的一般表示为：

$$
\begin{cases}
\dot{\mathbf{x}}(t) = A \mathbf{x}(t) + B \mathbf{u}(t) \\\\
\mathbf{y}(t) = C \mathbf{x}(t) + D \mathbf{u}(t)
\end{cases}
$$

设系统的初始条件为零，对上式取Laplace变换，得到：

$$
s\mathbf{X}(s) = A\mathbf{X}(s) + B\mathbf{U}(s) \\\\
\mathbf{Y}(s) = C\mathbf{X}(s) + D\mathbf{U}(s)
$$

由这两个式子可以解得：

$$\mathbf{X}(s) = (sI-A)^{-1} B \mathbf{U}(s)$$

$$\mathbf{Y}(s) = [C(sI-A)^{-1}B + D]\mathbf{U}(s)$$

因此可得传递函数$\mathbf{G}(s)$的表达式：

$$\mathbf{G}(s) = C(sI-A)^{-1}B + D$$

下面证明不同的状态方程表示对应的是同一个传递函数：由$\overline{A} = P A P^{-1}, \overline{B} = PB, \overline{C} = CP^{-1}, \overline{D} = D$，

$$\overline{\mathbf{G}}(s) = \overline{C}(sI-\overline{A})^{-1}\overline{B} + \overline{D} \\\\ = CP^{-1}(sI - PAP^{-1})^{-1}PB + D \\\\ = CP^{-1}(P(sI - A)P^{-1})^{-1}PB + D \\ = C(sI - A)^{-1}B + D = \mathbf{G}(s)$$

#### 传递函数模型到状态方程模型的转换

这是一种“一对多”的转换，比较复杂，下面仅介绍一种比较简单的变换方法。

设

$$G(s) = \frac{Y(s)}{U(s)} = \frac{b_0 s^m + b_1 s^{m-1} + \dots + b_{m-1}s + b_m}{s^n + a_1 s^{n-1} + \dots + a_{n-1}s + a_n}$$

其中$n \geq m$。下面分成$n > m$和$n = m$两种情况来讨论。事实上，这两种形式的主要区别是，$n = m$时，状态方程中才会出现$Du(t)$一项，其他时候是没有的。

##### n > m

引入中间变量

$$Z(s) = \frac{1}{s^n + a_1 s^{n-1} + \dots + a_{n-1}s + a_n} U(s)$$

即

$$(s^n + a_1 s^{n-1} + \dots + a_{n-1}s + a_n)Z(s) = U(s)$$

对应于上式的微分方程为

$$z^{(n)}(t) + a_1 z^{(n-1)}(t) + \dots + a_{n-1} \dot{z}(t) + a_n z(t) = u(t)$$

选取状态向量

$$
\mathbf{x}(t) =
\left[
\begin{matrix}
x_1(t) \\\\
x_2(t) \\\\
\vdots \\\\
x_n(t)
\end{matrix}
\right] =
\left[
\begin{matrix}
z(t) \\\\
\dot{z}(t) \\\\
\vdots \\\\
z^{(n-1)}(t)
\end{matrix}
\right]
$$

则有

##### n = m

## 习题

### 1

对于下图所示的电路，设$u_1(t)$是输入量，$u_2(t)$是输出量。
1. 要求列写出该电路系统的高阶微分方程。
2. 设$R_1 = 0.1M\Omega, R_2 = 0.5M\Omega, C_1 = 10\mu F, C_2 = 1 \mu F$，将（1）的结果写成数字形式。

![](01.jpg)

---

设中间变量$i_1(t)$为流经电容$C_1$的电流，$i_2(t)$为流经电容$C_2$的电流，则可列出原始微分方程如下：

$i_1 = C_1 \frac{d(u_1 - u_2)}{dt} = C_1\frac{du_1}{dt} - C_1\frac{du_2}{dt}$（电容$C_1$的电流与两端电压关系）

$i_2 - i_1 = \frac{u_1 - u_2}{R_1}$（$R_2$电流与电压关系）

$i_2 = C_2 \frac{d(u_2 - i_2 R_2)}{dt} = C_2 \frac{du_2}{dt} - R_2C_2\frac{di_2}{dt}$（电容$C_2$的电流与两端电压关系）

从前两个方程可得：

$$i_2 = i_1 + \frac{u_1 - u_2}{R_1} = C_1\frac{du_1}{dt} - C_1\frac{du_2}{dt} + \frac{u_1}{R_1} - \frac{u_2}{R_2}$$

将$i_2$的表达式代入第三个微分方程，整理后可得：

$$R_1R_2C_1C_2 \frac{d^2u_1}{dt^2} + (R_1C_1 + R_2C_2)\frac{du_1}{dt} + u_1 \\\\ = R_1R_2C_1C_2 \frac{d^2u_2}{dt^2} + (R_1C_2 + R_2C_2 + R_1C_1) \frac{du_2}{dt} + u_2$$

将具体数字代入，得到：

$$0.5 \frac{d^2u_1}{dt^2} + 1.5 \frac{du_1}{dt} + u_1 = 0.5 \frac{d^2u_2}{dt^2} + 1.6 \frac{du_2}{dt} + u_2$$

### 2

对于下图所示的机械位移系统，$M_1$和$M_2$是两个物体的质量，$K_1$和$K_2$是弹簧系数，$B_1$和$B_2$是粘滞阻尼系数。取$y_1(t), y_2(t), \dot{y}_1(t), \dot{y}_2(t)$为系统的状态变量，列出状态方程。

![](02.jpg)

---

好吧，第一个问题是，粘滞阻尼系数是什么鬼？下列描述来自百度百科：
>粘性阻尼是指当振动速度不大时，由于介质粘性引起的阻力近似地与速度成正比，即F=-cv，这样的阻尼称为粘性阻尼或线性阻尼。系数c 称为粘性阻尼系数（简称阻尼系数）。

所以这是一个与速度相关的阻力。

木有参考答案，所以先不做了……

### 3 微分方程转传递函数

已知系统的微分方程模型如下所示，其中$u(t)$是输入量，$y(t)$是输出量。求系统的传递函数模型$G(s) = Y(s) / U(s)$：

1. $y^{(3)}(t) + 2 y^{(2)}(t) + 5y't + 6y(t) = 3u'(t) + u(t)$
2. $y^{(4)}(t) + 10 y^{(2)}(t) + 6y'(t) + 3y(t) = 8u(t)$
3. $y^{(3)}(t) + 2 y^{(2)}(t) + y'(t) + 5y(t) + 3\int_{0}^{t} y(\tau) d\tau = 5u'(t) + 2u(t)$
4. $2y^{(2)}(t) + 3y'(t) + y(t) = u(t) + 2u(t - \tau)$

---

1. $\frac{Y(s)}{U(s)} = \frac{3s + 1}{s^3 + 2s^2 + 5s + 6}$
2. $\frac{Y(s)}{U(s)} = \frac{8}{s^4 + 10s^2 + 6s + 3}$
3. 根据Laplace变换的积分性质（$\mathcal{L}[\int_{0}^{t} f(\tau) d\tau] = \frac{1}{s} F(s)$）：$\frac{Y(s)}{U(s)} = \frac{s(5s + 2)}{s^4 + 2s^3 + s^2 + 5s + 3}$
4. 根据Laplace变换的延迟性质（$\mathcal{L}[f(t - \tau)] = e^{-\tau s} F(s)$）：$\frac{Y(s)}{U(s)} = \frac{1 + 2e^{-\tau s}}{2s^2 + 3s + 1}$（不过这似乎不是一个纯延时环节。）

### 4 微分方程组转传递函数矩阵

因为我们没有讲矩阵，所以就先不做了。

### 5 物理系统转状态方程

写出下图所示两个电路系统的状态方程。选择电容两端电压和流过电感的电流为状态变量。

![](05.jpg)

---

#### (a)

可以列出下面三个微分方程：

$$iR_3 + L \frac{di}{dt} = u_2 \\\\
R_2(i + C_2 \frac{du_2}{dt}) + u_2 = u_1 \\\\
R_1(i + C_2 \frac{du_2}{dt} + C_1 \frac{du_1}{dt}) + u_1 = e$$

将第二个方程代入第三个，经过整理，可以得到一阶微分方程组形式的模型：

$$
\begin{cases}
\frac{du_1}{dt} = -\frac{1}{C_1}(\frac{1}{R_1} + \frac{1}{R_2})u_1 + \frac{1}{R_2C_1}u_2 + \frac{1}{R_1C_1}e \\\\
\frac{du_2}{dt} = \frac{1}{R_2C_2}u_1 - \frac{1}{R_2C_2}u_2 - \frac{1}{C_2}i \\\\
\frac{di}{dt} = \frac{1}{L}u_2 - \frac{R_2}{L} i
\end{cases}
$$

令$\mathbf{x} = \left[
\begin{matrix}
u_1 \\\\
u_2 \\\\
i
\end{matrix}
\right]$，$u = e$，则状态方程可表示为$\dot{\mathbf{x}} = A \mathbf{x} + Bu$，其中：

$$A = \left[
\begin{matrix}
-\frac{1}{C_1}(\frac{1}{R_1} + \frac{1}{R_2}) & \frac{1}{R_2 C_1} & 0 \\\\
\frac{1}{R_2C_2} & -\frac{1}{R_2C_2} & -\frac{1}{C_2} \\\\
0 & \frac{1}{L} & -\frac{R_3}{L}
\end{matrix}\right],
B = \left[
\begin{matrix}
\frac{1}{R_1C_1} \\\\
0 \\\\
0
\end{matrix}
\right]$$

#### (b)


### 6 状态方程转传递函数
